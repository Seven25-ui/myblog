<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dashboard</title>
<style>
body{font-family:Arial;background:#f4f4f4;padding:20px}
.nav{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
.nav img{width:50px;height:50px;border-radius:50%}
.card{background:#fff;padding:15px;margin-bottom:15px;border-radius:8px;position:relative}
button,a.button{padding:5px 10px;background:#333;color:#fff;text-decoration:none;border:none;border-radius:5px;cursor:pointer;margin-right:5px}
form input, form textarea{width:100%;padding:8px;margin:5px 0}
form button{width:auto}
.flash{color:green;margin-bottom:10px}
</style>
</head>
<body>

<div class="nav">
  <div>
    <img src="{{ profile_pic }}" alt="Profile Pic">
    <span>{{ session.username }}</span>
  </div>
  <div>
    <a href="{{ url_for('add_post') }}" class="button">Add Post</a>
    <a href="{{ url_for('logout') }}" class="button">Logout</a>
  </div>
</div>

{% with messages = get_flashed_messages() %}
  {% if messages %}
    <div class="flash">
      {% for msg in messages %}{{ msg }}<br>{% endfor %}
    </div>
  {% endif %}
{% endwith %}

{% for post in posts %}
<div class="card">
  <h3>{{ post.title }}</h3>
  <p>{{ post.content }}</p>
  <small>by {{ post.user.username }} on {{ post.timestamp.strftime("%Y-%m-%d %H:%M") }}</small>
  <div style="margin-top:10px;">
    <a href="{{ url_for('edit_post', post_id=post.id) }}" class="button">Edit</a>
    <form action="{{ url_for('delete_post', post_id=post.id) }}" method="post" style="display:inline;">
      <button type="submit">Delete</button>
    </form>
  </div>

  <!-- COMMENTS -->
  <div style="margin-top:10px;">
    <form action="{{ url_for('add_comment', post_id=post.id) }}" method="post">
      <input type="text" name="comment" placeholder="Add a comment..." required>
      <button type="submit">Comment</button>
    </form>
    {% for c in post.comments %}
      <p>üí¨ {{ c.user.username }}: {{ c.content }}</p>
    {% endfor %}
  </div>

  <!-- REACTIONS -->
  <div style="margin-top:5px;">
    <form action="{{ url_for('react', post_id=post.id) }}" method="post" style="display:inline;">
      <input type="hidden" name="emoji" value="üëç">
      <button type="submit">üëç</button>
    </form>
    <form action="{{ url_for('react', post_id=post.id) }}" method="post" style="display:inline;">
      <input type="hidden" name="emoji" value="‚ù§Ô∏è">
      <button type="submit">‚ù§Ô∏è</button>
    </form>
    <form action="{{ url_for('react', post_id=post.id) }}" method="post" style="display:inline;">
      <input type="hidden" name="emoji" value="üòÇ">
      <button type="submit">üòÇ</button>
    </form>
  </div>
</div>
{% endfor %}

</body>
</html>
